(this["webpackJsonpexcel-automation"]=this["webpackJsonpexcel-automation"]||[]).push([[0],{38:function(e,t){},50:function(e,t,a){e.exports=a(72)},55:function(e,t,a){},61:function(e,t){},62:function(e,t){},67:function(e,t,a){e.exports=a.p+"static/media/Format.8dacd377.png"},72:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),o=a(40),l=a.n(o),i=(a(55),a(18)),c=a(15),s=a(47),p=a(13),d=a(5),m=a(25),u=a(87),f=Object(u.a)({grow:{flexGrow:1},linkContainer:{display:"flex"},link:{margin:"5px",padding:"10px 20px 10px 20px",backgroundColor:"#f8f8f8",color:"#434343",textDecoration:"none",borderRadius:"5px",transition:"0.5s",textTransform:"uppercase",fontSize:"1em",fontWeight:"bold","&:hover":{backgroundColor:"#d5d5d5",transition:"0.5s"}},root:{marginTop:"50px",justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column",height:"100%"},label:{fontWeight:"bold",fontSize:"20px",paddingTop:"5px",paddingBottom:"5px"},inputWrapper:{margin:"20px 0px"},input:{padding:"5px"},download:{backgroundColor:"darkorange",color:"white",width:"250px",height:"50px",borderRadius:"5px",fontSize:"1em",border:"none",transition:"1s",fontWeight:"bold",textTransform:"uppercase","&:hover":{backgroundColor:"#ff6500",transition:"1s"}},fileUploadContainer:{padding:"10px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"space-between",width:"80%"},fileUploadWrapper:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},fileUpload:{height:"60px",backgroundColor:"white",border:"none"}}),g=a(91),h=function(){var e=Object(r.useState)({}),t=Object(p.a)(e,2),o=t[0],l=t[1],i=Object(r.useState)({}),c=Object(p.a)(i,2),u=c[0],h=c[1],b=Object(r.useState)({}),v=Object(p.a)(b,2),y=v[0],x=v[1],E=Object(r.useState)(""),O=Object(p.a)(E,2),j=(O[0],O[1]),k=f(),N=function(e,t){e.preventDefault();var a=e.target.files[0],r=new FileReader;r.onload=function(e){!function(e,t){var a=d.read(e,{type:"binary"}),r=d.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1});j(r[0][0]);for(var n=1;n<r[0].length;n++){var o=parseInt(r[0][n]);o in y||(y[o]=1)}x(y);for(var i={},c=1;c<r.length;c++){for(var s=r[c][0],p={},m=1;m<r[c].length;m++){var u=parseInt(r[0][m]),f=r[c][m];p[u]=f}i[s]=p}delete i[void 0],t?l(i):h(i)}(e.target.result,t)},r.readAsBinaryString(a)};return n.a.createElement("div",{className:k.root},n.a.createElement("span",{className:k.label,style:{fontSize:"30px",marginBottom:"30px"}},"Upload Excel Files Here"),n.a.createElement("div",{className:k.fileUploadContainer,style:{flexDirection:"row",width:"40%"}},n.a.createElement("div",{className:k.fileUploadWrapper},n.a.createElement("span",{className:k.label},"File 1"),n.a.createElement(g.a,{onChange:function(e){return N(e,!0)},type:"file",className:k.fileUpload})),n.a.createElement("div",{className:k.fileUploadWrapper},n.a.createElement("span",{className:k.label},"File 2"),n.a.createElement(g.a,{onChange:function(e){return N(e,!1)},type:"file",disabled:0===Object.keys(o).length,className:k.fileUpload}))),n.a.createElement("section",{className:k.fileUploadContainer},n.a.createElement("span",{className:k.label},"Mark Up Value ",n.a.createElement("span",{style:{color:"red",fontSize:"13px"}},"(numbers/ decimal only)")),n.a.createElement("div",{className:0!==Object.keys(y).length&&k.inputWrapper},Object.keys(y).map((function(e){return n.a.createElement("div",{key:e,className:k.input},n.a.createElement("label",{style:{paddingRight:"10px"}},"Q - ",e),n.a.createElement("input",{type:"number",onChange:function(t){return function(e,t){var a=JSON.parse(JSON.stringify(y));0===e.toString().length?(a[t]=1,x(a)):(a[t]=parseFloat(e),x(a))}(t.target.value,e)},value:y[e]}))}))),0===Object.keys(y).length&&n.a.createElement("div",null,n.a.createElement("h4",{style:{color:"#333333",textTransform:"uppercase"}},"[Multiplier fields will display once file is uploaded]")),n.a.createElement("button",{onClick:function(){return function(){if(0!==Object.keys(u).length)for(var e=Object.keys(o),t=Object.keys(u),a=e.concat(t),r=Object(s.a)(new Set(a)),n=Object.keys(y),l=0;l<r.length;l++){var i={};if(void 0===o[r[l]])for(var c=0;c<n.length;c++)i[n[c]]=u[r[l]][n[c]];else if(void 0===u[r[l]])for(var p=0;p<n.length;p++)i[n[p]]=o[r[l]][n[p]];else for(var f=0;f<n.length;f++){var g=o[r[l]],h=u[r[l]];void 0===g[n[f]]?i[n[f]]=h[n[f]]:void 0===h[n[f]]?i[n[f]]=g[n[f]]:i[n[f]]=g[n[f]]<h[n[f]]?g[n[f]]:h[n[f]]}o[r[l]]=i}for(var b=Object.keys(o),v=[],x=["MPN"],E=o[b[0]],O=0;O<Object.keys(E).length;O++)x.push(Object.keys(E)[O]);for(var j=0;j<b.length;j++){var k={};k.MPN=b[j];for(var N=o[b[j]],C=Object.keys(N),w=Object.values(N),S=0;S<C.length;S++)isNaN(parseFloat(w[S]))||(k[C[S]]=w[S]*y[C[S]]);v.push(k)}var U={Sheets:{data:d.utils.json_to_sheet(v,{header:x})},SheetNames:["data"]},D=d.write(U,{bookType:"xlsx",type:"array"}),P=new Blob([D],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});m.saveAs(P,"Data.xlsx")}()},className:k.download,disabled:0===Object.keys(o).length},"Download")),n.a.createElement("div",{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"}},n.a.createElement("h3",null,"Your Uploaded File ",n.a.createElement("span",{style:{fontWeight:"bold",color:"red",fontSize:"20px"}},"MUST")," follow the following format: "),n.a.createElement("img",{alt:"Sample Format",src:a(67),width:"80%",style:{borderRadius:"10px"}})))},b=a(14),v=function(){var e=f(),t=Object(r.useState)({EURO:1,USD:1}),a=Object(p.a)(t,2),o=a[0],l=a[1],i=Object(r.useState)({}),c=Object(p.a)(i,2),s=c[0],u=(c[1],Object(r.useState)({})),h=Object(p.a)(u,2),v=h[0],y=(h[1],function(e,t){e.preventDefault();var a=e.target.files[0],r=new FileReader;r.onload=function(e){1===t?function(e){var t=d.read(e,{type:"binary"}),a=d.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1});l({EURO:a[3][2],USD:a[4][2]});for(var r=2;r<a[0].length;r++){var n=parseInt(a[0][r]);n in s||(s[n]={handlingCharge:a[1][r],markUp:a[2][r]})}for(var o=7;o<a.length&&void 0!==a[o][1];o++){var i=a[o][1],c=a[o][2],p=a[o][3],m=void 0===a[o][4]?"":a[o][4];0!=p&&(v[i]={brand:c,qty:p,remarks:m})}}(e.target.result):2===t?function(e){for(var t=d.read(e,{type:"binary"}),a=d.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),r=1;r<a.length&&void 0!==a[r][1];r++){var n=a[r][0],l=a[r][1],i=a[r][2],c=x(a[r][3]);n in v&&(null!=v[n].opoDate?(v[n].opoDate===c.getTime()&&v[n].opoPrice*o[v[n].opoCurr]<i*o[l]||v[n].opoDate<c.getTime())&&(v[n]=Object(b.a)(Object(b.a)({},v[n]),{},{opoCurr:l,opoPrice:i,opoDate:c})):v[n]=Object(b.a)(Object(b.a)({},v[n]),{},{opoCurr:l,opoPrice:i,opoDate:c}))}}(e.target.result):function(e){for(var t=d.read(e,{type:"binary"}),a=d.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),r=1;r<a.length&&void 0!==a[r][1];r++){var n=a[r][1],l=a[r][2],i=a[r][3],c=x(a[r][0]);n in v&&(null!=v[n].grDate?(v[n].grDate===c.getTime()&&v[n].grPrice*o[v[n].grCurr]<i*o[l]||v[n].grDate<c.getTime())&&(v[n]=Object(b.a)(Object(b.a)({},v[n]),{},{grCurr:l,grPrice:i,grDate:c})):v[n]=Object(b.a)(Object(b.a)({},v[n]),{},{grCurr:l,grPrice:i,grDate:c}))}}(e.target.result)},r.readAsBinaryString(a)}),x=function(e){var t=Math.floor(e-25569),a=new Date(1e3*(86400*t));return new Date(a.getFullYear(),a.getMonth(),a.getDate())};return n.a.createElement("div",{className:e.root},n.a.createElement("span",{className:e.label,style:{fontSize:"30px",marginBottom:"30px"}},"Upload Excel Files Here"),n.a.createElement("div",{className:e.fileUploadContainer,style:{flexDirection:"row",width:"60%"}},n.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},n.a.createElement("span",{className:e.label},"Stock Available"),n.a.createElement(g.a,{onChange:function(e){return y(e,1)},type:"file",className:e.fileUpload})),n.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},n.a.createElement("span",{className:e.label},"OpenPoPriceList"),n.a.createElement(g.a,{onChange:function(e){return y(e,2)},type:"file",className:e.fileUpload})),n.a.createElement("div",{className:e.fileUploadWrapper,style:{width:"30%"}},n.a.createElement("span",{className:e.label},"GoodsReceivedPriceList"),n.a.createElement(g.a,{onChange:function(e){return y(e,3)},type:"file",className:e.fileUpload}))),n.a.createElement("div",{style:{marginTop:"50px"}},n.a.createElement("button",{onClick:function(){return function(){for(var e=[],t=Object.keys(v),a=["Line","MPN","Brand","Stock","Curr (GR)","Price (GR)","Curr (OPO)","Price (OPO)"],r=0;r<Object.keys(s);r++)a.push(Object.keys(s)[r]);for(var n=0;n<t.length;n++){var l={},i=t[n];l.Line=n+1,l.MPN=i,l.Brand=v[i].brand,l.Stock=v[i].qty,l["Curr (GR)"]=v[i].grCurr,l["Price (GR)"]=v[i].grPrice,l["Curr (OPO)"]=v[i].opoCurr,l["Price (OPO)"]=v[i].opoPrice;for(var c=v[i].grPrice*o[v[i].grCurr],p=v[i].opoPrice*o[v[i].opoCurr],u=c>p?c:p,f=0;f<Object.keys(s).length;f++){var g=Object.keys(s)[f],h=((1+1*s[g].markUp/100)*u*g+s[g].handlingCharge)/g;l[g]=isNaN(h)?"-":h}e.push(l)}var b={Sheets:{data:d.utils.json_to_sheet(e,{header:a})},SheetNames:["data"]},y=d.write(b,{bookType:"xlsx",type:"array"}),x=new Blob([y],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});m.saveAs(x,"Data.xlsx")}()},className:e.download},"Download")))},y=a(92),x=a(89),E=a(90),O=function(){var e=f();return n.a.createElement(i.a,null,n.a.createElement(y.a,{position:"static",style:{backgroundColor:"darkorange"}},n.a.createElement(x.a,null,n.a.createElement(E.a,{className:e.label,noWrap:!0,style:{fontSize:"22px"}},"Wiselink Excel Automation"),n.a.createElement("div",{className:e.grow}),n.a.createElement("div",{className:e.linkContainer},n.a.createElement(i.b,{to:"/excel-automation",className:e.link},"Compile"),n.a.createElement(i.b,{to:"/excel-automation/compare",className:e.link},"Compare")))),n.a.createElement(c.c,null,n.a.createElement(c.a,{path:"/",component:h}),n.a.createElement(c.a,{path:"/compare",component:v})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(i.a,{basename:"/excel-automation/"},n.a.createElement(O,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[50,1,2]]]);
//# sourceMappingURL=main.19fc8341.chunk.js.map