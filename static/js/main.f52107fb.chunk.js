(this["webpackJsonpexcel-automation"]=this["webpackJsonpexcel-automation"]||[]).push([[0],{20:function(e,t){},25:function(e,t,a){e.exports=a(43)},30:function(e,t,a){},36:function(e,t){},37:function(e,t){},38:function(e,t,a){e.exports=a.p+"static/media/Format.c48584e9.png"},43:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(22),l=a.n(o),i=(a(30),a(6)),c=a(1),s=a(24),u=a(5),p=a(2),m=a(12),d=function(){var e=Object(n.useState)({}),t=Object(u.a)(e,2),o=t[0],l=t[1],i=Object(n.useState)({}),c=Object(u.a)(i,2),d=c[0],f=c[1],h=Object(n.useState)({}),g=Object(u.a)(h,2),v=g[0],y=g[1],b=Object(n.useState)(""),E=Object(u.a)(b,2),x=E[0],j=E[1],O=function(e,t){e.preventDefault();var a=e.target.files[0],n=new FileReader;n.onload=function(e){!function(e,t){var a=p.read(e,{type:"binary"}),n=p.utils.sheet_to_json(a.Sheets[a.SheetNames[0]],{header:1});j(n[0][0]);for(var r=1;r<n[0].length;r++){var o=parseInt(n[0][r]);o in v||(v[o]=1)}y(v);for(var i={},c=1;c<n.length;c++){for(var s=n[c][0],u={},m=1;m<n[c].length;m++){var d=parseInt(n[0][m]),h=n[c][m];u[d]=h}i[s]=u}delete i[void 0],t?l(i):f(i)}(e.target.result,t)},n.readAsBinaryString(a)};return r.a.createElement("div",{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"}},r.a.createElement("h2",null,"Upload Excel Files Here"),r.a.createElement("div",{style:{paddingBottom:"20px",display:"flex",flexDirection:"row"}},r.a.createElement("div",null,r.a.createElement("div",{style:{fontWeight:"bold",fontSize:"14px"}},"File 1"),r.a.createElement("input",{type:"file",onChange:function(e){return O(e,!0)}})),r.a.createElement("div",null,r.a.createElement("div",{style:{fontWeight:"bold",fontSize:"14px"}},"File 2"),r.a.createElement("input",{type:"file",onChange:function(e){return O(e,!1)},disabled:0===Object.keys(o).length}))),r.a.createElement("div",{style:{paddingBottom:"30px"}},r.a.createElement("h2",null,"Mark Up Value ",r.a.createElement("span",{style:{color:"red",fontSize:"13px"}},"(numbers/ decimal only)")),Object.keys(v).map((function(e){return r.a.createElement("div",{key:e},r.a.createElement("label",{style:{paddingRight:"10px"}},"Q - ",e),r.a.createElement("input",{type:"number",onChange:function(t){return function(e,t){console.log(e,t);var a=JSON.parse(JSON.stringify(v));0===e.toString().length?(a[t]=1,y(a)):(a[t]=parseFloat(e),y(a)),console.log(a)}(t.target.value,e)},value:v[e]}))})),0===Object.keys(v).length&&r.a.createElement("div",null,r.a.createElement("h4",{style:{color:"#333333",textTransform:"uppercase"}},"[Multiplier fields will display once file is uploaded]")),r.a.createElement("button",{onClick:function(){return function(){if(0!==Object.keys(d).length)for(var e=Object.keys(o),t=Object.keys(d),a=e.concat(t),n=Object(s.a)(new Set(a)),r=Object.keys(v),l=0;l<n.length;l++){var i={};if(void 0===o[n[l]])for(var c=0;c<r.length;c++)i[r[c]]=d[n[l]][r[c]];else if(void 0===d[n[l]])for(var u=0;u<r.length;u++)i[r[u]]=o[n[l]][r[u]];else for(var f=0;f<r.length;f++){var h=o[n[l]],g=d[n[l]];void 0===h[r[f]]?i[r[f]]=g[r[f]]:void 0===g[r[f]]?i[r[f]]=h[r[f]]:i[r[f]]=h[r[f]]<g[r[f]]?h[r[f]]:g[r[f]]}o[n[l]]=i}for(var y=Object.keys(o),b=[],E=0;E<y.length;E++){var j={};j[x]=y[E];for(var O=o[y[E]],S=Object.keys(O),k=Object.values(O),C=0;C<S.length;C++)isNaN(parseFloat(k[C]))||(j["["+S[C].toString()+"]"]=k[C]*v[S[C]]);b.push(j)}var w={Sheets:{data:p.utils.json_to_sheet(b)},SheetNames:["data"]},D=p.write(w,{bookType:"xlsx",type:"array"}),P=new Blob([D],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});m.saveAs(P,"Data.xlsx")}()},style:{marginTop:"20px",width:"200px",height:"40px",border:"none",fontWeight:"bold"},disabled:0===Object.keys(o).length},"Download")),r.a.createElement("div",{style:{justifyContent:"center",alignItems:"center",display:"flex",flexDirection:"column"}},r.a.createElement("h3",null,"Your Uploaded File ",r.a.createElement("span",{style:{fontWeight:"bold",color:"red",fontSize:"20px"}},"MUST")," follow the following format: "),r.a.createElement("img",{alt:"Sample Format",src:a(38),width:"80%",style:{borderRadius:"10px"}})))},f=a(10),h=function(){var e=Object(n.useState)({EURO:1,USD:1}),t=Object(u.a)(e,2),a=t[0],o=t[1],l=Object(n.useState)({}),i=Object(u.a)(l,2),c=i[0],s=(i[1],Object(n.useState)({})),d=Object(u.a)(s,2),h=d[0],g=(d[1],function(e,t){e.preventDefault();var n=e.target.files[0],r=new FileReader;r.onload=function(e){1===t?function(e){var t=p.read(e,{type:"binary"}),a=p.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1});o({EURO:a[3][2],USD:a[4][2]});for(var n=2;n<a[0].length;n++){var r=parseInt(a[0][n]);r in c||(c[r]={handlingCharge:a[1][n],markUp:a[2][n]})}for(var l=7;l<a.length&&void 0!==a[l][1];l++){var i=a[l][1],s=a[l][2],u=a[l][3],m=void 0===a[l][4]?"":a[l][4];0!=u&&(h[i]={brand:s,qty:u,remarks:m})}}(e.target.result):2===t?function(e){for(var t=p.read(e,{type:"binary"}),n=p.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),r=1;r<n.length&&void 0!==n[r][1];r++){var o=n[r][0],l=n[r][1],i=n[r][2],c=v(n[r][3]);o in h&&(null!=h[o].opoDate?(h[o].opoDate===c.getTime()&&h[o].opoPrice*a[h[o].opoCurr]<i*a[l]||h[o].opoDate<c.getTime())&&(h[o]=Object(f.a)({},h[o],{opoCurr:l,opoPrice:i,opoDate:c})):h[o]=Object(f.a)({},h[o],{opoCurr:l,opoPrice:i,opoDate:c}))}}(e.target.result):function(e){for(var t=p.read(e,{type:"binary"}),n=p.utils.sheet_to_json(t.Sheets[t.SheetNames[0]],{header:1}),r=1;r<n.length&&void 0!==n[r][1];r++){var o=n[r][1],l=n[r][2],i=n[r][3],c=v(n[r][0]);o in h&&(null!=h[o].grDate?(h[o].grDate===c.getTime()&&h[o].grPrice*a[h[o].grCurr]<i*a[l]||h[o].grDate<c.getTime())&&(h[o]=Object(f.a)({},h[o],{grCurr:l,grPrice:i,grDate:c})):h[o]=Object(f.a)({},h[o],{grCurr:l,grPrice:i,grDate:c}))}}(e.target.result)},r.readAsBinaryString(n)}),v=function(e){var t=Math.floor(e-25569),a=new Date(1e3*(86400*t));return new Date(a.getFullYear(),a.getMonth(),a.getDate())};return r.a.createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"}},r.a.createElement("h2",null,"Upload Excel Files Here"),r.a.createElement("div",{style:{width:"50%",paddingBottom:"20px",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",null,r.a.createElement("div",{style:{fontWeight:"bold",fontSize:"16px"}},"Stock Available"),r.a.createElement("input",{type:"file",onChange:function(e){return g(e,1)}})),r.a.createElement("div",null,r.a.createElement("div",{style:{fontWeight:"bold",fontSize:"16px"}},"OpenPoPriceList"),r.a.createElement("input",{type:"file",onChange:function(e){return g(e,2)}})),r.a.createElement("div",null,r.a.createElement("div",{style:{fontWeight:"bold",fontSize:"16px"}},"GoodsReceivedPriceList"),r.a.createElement("input",{type:"file",onChange:function(e){return g(e,3)}}))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){return function(){var e=[],t=Object.keys(h),n=["Line","MPN","Brand","Stock","Gr-Curr","GR-Price","Opo-Curr","Opo-Price"];for(var r in Object.keys(c))n.push("["+r+"]");for(var o=0;o<t.length;o++){var l={},i=t[o];l.Line=o+1,l.MPN=i,l.Brand=h[i].brand,l.Stock=h[i].qty,l["GR-Curr"]=h[i].grCurr,l["GR-Price"]=h[i].grPrice,l["Opo-Curr"]=h[i].opoCurr,l["Opo-Price"]=h[i].opoPrice;for(var s=h[i].grPrice*a[h[i].grCurr],u=h[i].opoPrice*a[h[i].opoCurr],d=s>u?s:u,f=0;f<Object.keys(c).length;f++){var g=Object.keys(c)[f],v=((1+1*c[g].markUp/100)*d*g+c[g].handlingCharge)/g;l["["+g+"]"]=isNaN(v)?"-":v}e.push(l)}console.log(n);var y={Sheets:{data:p.utils.json_to_sheet(e)},SheetNames:["data"]},b=p.write(y,{bookType:"xlsx",type:"array",header:n}),E=new Blob([b],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});m.saveAs(E,"Data.xlsx")}()},style:{marginTop:"20px",width:"200px",height:"40px",border:"none",fontWeight:"bold"}},"Download")))},g=function(){return r.a.createElement(i.a,null,r.a.createElement("div",null,r.a.createElement("h2",null,"Wiselink Excel Automation"),r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},r.a.createElement("ul",{className:"navbar-nav mr-auto"},r.a.createElement("li",null,r.a.createElement(i.b,{to:"/excel-automation",className:"nav-link"},"Compile")),r.a.createElement("li",null,r.a.createElement(i.b,{to:"/excel-automation/compare",className:"nav-link"},"Compare")))),r.a.createElement("hr",null),r.a.createElement(c.c,null,r.a.createElement(c.a,{exact:!0,path:"/excel-automation",component:d}),r.a.createElement(c.a,{path:"/excel-automation/compare",component:h}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(i.a,null,r.a.createElement(g,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[25,1,2]]]);
//# sourceMappingURL=main.f52107fb.chunk.js.map